# IMP-004: План реализации упаковки DCL Agent

**Версия:** 1.0
**Спринт:** SP-004
**Дата:** 2025-12-26

---

## 1. Цель
Реализовать поддержку установки агента как Python-пакета и обновить рабочий ноутбук.

## 2. Milestones

### Milestone 1: Конфигурация сборки
Создание файла `pyproject.toml` в директории `src/dcl_agent`.
**Задачи:**
1.  **[PACK-01]** Создать `src/dcl_agent/pyproject.toml` с метаданными и зависимостями (`lark`, `google-genai`, `PyYAML`).
2.  **[PACK-02]** Добавить `src/dcl_agent/MANIFEST.in` (опционально, если потребуется для включения не-python файлов, пока без него, т.к. `setuptools` по умолчанию включает пакеты).
3.  **[VERIFY-01]** Проверить локальную установку: `pip install -e src/dcl_agent`.

### Milestone 2: Обновление Notebook
Адаптация `dcl-agent.ipynb` для работы с установленным пакетом.
**Задачи:**
1.  **[NB-01]** Добавить ячейку "Setup & Installation" с командами для Local и Colab.
2.  **[NB-02]** Удалить манипуляции с `sys.path`.
3.  **[NB-03]** Обновить импорты на `from dcl_agent.agent import DCLAgent`.
4.  **[VERIFY-02]** Проверить исполнение ноутбука локально.

---

## 3. План верификации (Regression Test Plan)

### Автоматические тесты
- Существующие тесты (`pytest`) должны проходить. Упаковка не должна ломать код.
- **Действие:** Запустить `pytest` после изменений.

### Ручная верификация
1.  **Локальная установка:**
    - Создать чистый venv (или использовать текущий).
    - Выполнить `pip install -e src/dcl_agent`.
    - Проверить `pip list` — пакет `dcl-agent` должен быть виден.
2.  **Notebook:**
    - Открыть `notebooks/dcl-agent.ipynb`.
    - Перезапустить ядро.
    - Выполнить все ячейки.
    - Убедиться, что агент инициализируется и выполняет тестовую инструкцию.

---

## 4. Неизменяемые компоненты
- Логика `dcl_agent` (parser, registry, loader, strategies).
- Тесты.

---

## 5. Открытые вопросы
Нет.
